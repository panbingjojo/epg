<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>主页3</title>
    <meta charset="utf-8" name="page-view-size" content="{$size}">
    <link rel="stylesheet" type="text/css" href="__ROOT__/Public/css/{$platformType}/common.css?t={$time}">
    <link rel="stylesheet" type="text/css" href="__ROOT__/Public/css/{$platformType}/Activity/ActivityConsultation/V1/ExpertDetails.css?t={$time}">
    <!--第三方依赖库-->
    <script type="text/javascript" src="__ROOT__/Public/ThirdParty/js/json2.js?t={$time}"></script>
    <!--公用库-->
    <script type="text/javascript" src="__ROOT__/Public/Common/js/lmcommon.js?t={$time}"></script>
    <eq name="isRunOnAndroid" value="1">
        <script type="text/javascript" src="__ROOT__/Public/Common/js/android.js?t={$time}"></script>
    </eq>
    <script type="text/javascript" src="__ROOT__/Public/Common/js/lmui.js?t={$time}"></script>
    <script type="text/javascript" src="__ROOT__/Public/Common/js/lminquiry.js?t={$time}"></script>
    <script type="text/javascript" src="__ROOT__/Public/Common/js/lmauthEx.js?t={$time}"></script>
</head>
<body style=" background-image: url('__ROOT__/Public/img/{$platformType}/Activity/ActivityConsultation/V1/bg.png')">
<img id="back_btn" class="btn" src="__ROOT__/Public/img/{$platformType}/Activity/ActivityConsultation/V1/inde_back_out.png"/>
<div class="common_bg">
    <img id="photo_img" src="" onerror="this.src='__ROOT__/Public/img/hd/Expert/init_doctor.png'"/>
    <div class="title">
        <span id="doctor"></span>&nbsp;|&nbsp;<span id="job_name"></span>&nbsp;|&nbsp;<span id="hospital"></span>
    </div>
    <div id="content"></div>
    <div class="good_at">擅长：</div>
    <img id="reservation_btn" class="btn"
         src="__ROOT__/Public/img/{$platformType}/Activity/ActivityConsultation/V1/reservation_out.png"/>
</div>

<script type="text/javascript">
    function getCurPageObj() {
        var objCurrent = LMEPG.Intent.createIntent("activity-consultation-new-detail");
        objCurrent.setParam("clinicId", initClinicId);
        return objCurrent;
    }

    function jumpCode() {
        var jumpCodeObj = LMEPG.Intent.createIntent("activity-consultation-new-code");
        var curObj = getCurPageObj();
        jumpCodeObj.setParam("clinicId", initClinicId);
        LMEPG.Intent.jump(jumpCodeObj, curObj);
    }


</script>

<script type="text/javascript">
    var eleName = G("doctor");
    var eleJob = G("job_name");
    var eleHospital = G("hospital");
    var eleGood = G("content");
    var eleHeaderImg = G("photo_img");


    function onBack() {
        LMEPG.Intent.back();
    }

    var buttons = [
        {
            id: 'back_btn',
            name: '返回',
            type: 'img',
            nextFocusLeft: 'reservation_btn',
            nextFocusUp: '',
            nextFocusRight: '',
            nextFocusDown: 'reservation_btn',
            backgroundImage: '__ROOT__/Public/img/{$platformType}/Activity/ActivityConsultation/V1/inde_back_out.png',
            focusImage: '__ROOT__/Public/img/{$platformType}/Activity/ActivityConsultation/V1/inde_back_in.png',
            click: "onBack()",
            focusChange: "",
            beforeMoveChange: "",
            moveChange: "",
        },
        {
            id: 'reservation_btn',
            name: '预约',
            type: 'img',
            nextFocusLeft: '',
            nextFocusUp: 'back_btn',
            nextFocusRight: 'back_btn',
            nextFocusDown: '',
            backgroundImage: '__ROOT__/Public/img/{$platformType}/Activity/ActivityConsultation/V1/reservation_out.png',
            focusImage: '__ROOT__/Public/img/{$platformType}/Activity/ActivityConsultation/V1/reservation_in.png',
            click: "jumpCode()",
            focusChange: "",
            beforeMoveChange: "",
            moveChange: "",
        }]
</script>

<script type="text/javascript">
    var initClinicId = "{$clinicId}";
    window.onload = function (ev) {
        LMEPG.ButtonManager.init(['reservation_btn'], buttons, '', true);
        updateUI();
    };

    function updateUI() {
        LMEPG.UI.showWaitingDialog("");
        LMEPG.Inquiry.expertApi.getExpertDetail(initClinicId, function (rsp) {
            LMEPG.UI.dismissWaitingDialog();
            try {
                var tempData = rsp instanceof Object ? rsp :  JSON.parse(rsp);
                var code = parseInt(tempData.code);
                if (code === 0) {
                    var expertObj = tempData["data"][0];
                    eleHeaderImg.src = expertObj.doctor_avatar;
                    eleName.innerHTML = expertObj.doctor_name;
                    eleJob.innerHTML = expertObj.doctor_level;
                    eleHospital.innerHTML = expertObj.doctor_hospital_name;
                    if (null != expertObj.doctor_skill || undefined != expertObj.doctor_skill || "" != expertObj.doctor_skill) {
                        eleGood.innerHTML = "暂无";
                    } else {
                        eleGood.innerHTML = expertObj.doctor_skill;
                    }
                } else {
                    LMEPG.UI.showToast("加载失败:" + code);
                }
            } catch (e) {
                LMEPG.UI.showToast("获取专家详情数据解析异常！");
            }
        }, function (rsp) {
            LMEPG.UI.dismissWaitingDialog();
            LMEPG.UI.showToast("获取专家详情请求失败");
        });
    }
</script>
</body>
</html>