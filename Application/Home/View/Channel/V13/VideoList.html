<!DOCTYPE html>
<html lang="en">
<head>
    <title>三级视频栏目(视频集)-carrierIdSet</title>
    <meta charset="utf-8" name="page-view-size" content="{$size}">
    <link rel="stylesheet" type="text/css" href="__ROOT__/Public/css/{$platformType}/common.css?t={$time}"/>
    <link rel="stylesheet" type="text/css" href="__ROOT__/Public/css/{$platformType}/Common/V13/dialog.css?t={$time}"/>
    <link rel="stylesheet" type="text/css" href="__ROOT__/Public/css/{$platformType}/Channel/V13/VideoList.css?t={$time}"/>

    <!--全局渲染参数-->
    <script type="text/javascript">
        var RenderParam = {
            //公共渲染
            isRunOnAndroid: "{$isRunOnAndroid}",// 是否运行在apk平台
            carrierId: '{$carrierId}',          // 地区id
            areaCode: '{$areaCode}',            // 省份地区码
            platformType: '{$platformType}',    // 平台类型
            debug: '{$debug}',                  // 调试模式
            pageSize: '{$size}',                // 页面尺寸
            stbModel: '{$stbModel}',            // 盒子的型号
            fsUrl: '{$resourcesUrl}',           // fs 地址
            time: '{$time}',                    // 开始渲染时间
            userId: '{$userId}',                // 用户Id
            accountId: '{$accountId}',          // 用户账号
            //当前页渲染
            detail: '{$detail | json_encode}',        // 详情
            isCollect: '{$isCollect}',                // 是否收藏（0-未收藏 1-已收藏）
            isVip: '{$isVip}',                        // 用户是否是vip
            latestVideoInfo: {$latestVideoInfo},      // 最近播放的视频
            thirdPlayerUrl: '{$domainUrl}',           // 第三方播放器根路径地址
            skin: {$skin},      // 用户自定义背景
            // 焦点保持

            focusId: "{$focusId}",
            listPage: "{$listPage}",
            tabPage: "{$tabPage}",
            keepFocusId: "{$keepFocusId}",
            CWS_HLWYY_URL: '{$cwsHlwyyUrl}',
            teletextInquiryUrl: '{$teletextInquiryUrl}', // 图文问诊地址
            videolist: 'videolist',
            noSmallVideo: '{$noSmallVideo}',

            // 是否显示【一键问医】按钮
            isShowAskDoctor: '{$isShowAskDoctor}',
            isExitApp: "{$isExitApp}",
        };
    </script>

    <if condition="$carrierId eq '410092' ">
        <!--河南电信EPG js文件-->
        <script type="text/javascript" src="__ROOT__/Public/ThirdParty/js/410092/vod_utils.js?t={$time}"></script>
    </if>

    <!--第三方依赖库-->
    <script type="text/javascript" src="__ROOT__/Public/ThirdParty/js/json2.js?t={$time}"></script>
    <!--公共库-->
    <script type="text/javascript" src="__ROOT__/Public/Common/js/lmcommon.js?t={$time}"></script>
    <!--    是否在安卓环境中运行-->
    <eq name="isRunOnAndroid" value="1">
        <script type="text/javascript" src="__ROOT__/Public/Common/js/android.js?t={$time}"></script>
    </eq>
    <script type="text/javascript" src="__ROOT__/Public/Common/js/lmui.js?t={$time}"></script>
    <script type="text/javascript" src="__ROOT__/Public/Common/js/lmplayer.js?t={$time}"></script>
    <script type="text/javascript" src="__ROOT__/Public/Common/js/lminquiry.js?t={$time}"></script>
    <if condition="$carrierId eq '450094' ">
        <!-- 广西广电小窗视频播放 -->
        <script type="text/javascript" src="http://10.1.15.25/webJS/gxgd.config.js?t={$time}"></script>
        <script type="text/javascript" src="http://10.1.15.25/webJS/starcorCom.js?t={$time}"></script>
    </if>
    <!--当前模块js-->
    <script type="text/javascript" src="__ROOT__/Public/js/Dialog/Dialog.1.01.js?t={$time}"></script>
    <script type="text/javascript" src="__ROOT__/Public/js/Player/LMSmallPlayer.js?t={$time}"></script>
    <script type="text/javascript" src="__ROOT__/Public/js/Channel/V13/VideoList.js?t={$time}"></script>
</head>

<body bgcolor="transparent">
<div id="debug"></div>
<a href="#" id="grabFocus"><img class="grubFocusImg" src="__ROOT__/Public/img/Common/spacer.gif" alt=""/></a>
<img id="video-TV" src="__ROOT__/Public/img/Common/spacer.gif" alt="">

<!-- 小窗（江苏电信） -->
<div class="small_screen_player">
    <if condition="$carrierId neq 640094">
        <iframe id="iframe_small_screen" frameborder="0" scrolling="no"></iframe>
    </if>
</div>

<!-- 无小窗口播放，设置位置为推荐位 -->
<eq name="noSmallVideo" value="1">
    <img id="cover-img" src="" alt=""/>
</eq>
<ul id="video-desc-wrapper">
    <li class="desc-title" id="desc-title"></li>
    <li class="desc-total" id="desc-total"></li>
    <li class="desc-text" id="desc-text"></li>
    <li class="desc-icon" id="desc-icon">
        <span id="sm-current"></span>
        <img id="full-screen" src="__ROOT__/Public/img/hd/Channel/V13/full_screen.png" alt="">
        <img id="collect" src="__ROOT__/Public/img/hd/Channel/V13/collect.png" alt="">
        <if condition="$isShowAskDoctor">
            <img id="one-key-inquiry" src="__ROOT__/Public/img/hd/Channel/V13/one_key_inquiry.png" alt="">
        </if>
    </li>
</ul>

<!--视频列表-->
<div id="container">
    <ul id="tab-wrap"></ul>
    <img id="nav-next" src="__ROOT__/Public/img/hd/Channel/V13/nav_next.png" alt="">
    <div id="content-wrap"></div>
    <img id="prev-arrow" class="arrow" src="__ROOT__/Public/img/hd/Home/V13/Home/Common/left.png" alt="上页箭头">
    <img id="next-arrow" class="arrow" src="__ROOT__/Public/img/hd/Home/V13/Home/Common/right.png" alt="下页箭头">
</div>

<!-- 无数据 -->
<div id="null-data-000051">无视频数据~</div>
</body>

<script type="text/javascript">
    window.onload = function () {
        try{
            LMEPG.Log.debug("videoList.html---init--start");
            LMEPG.UI.setBackGround('spj');
            Level3.init();
            LMEPG.Log.debug("videoList.html---init--end");

            if(RenderParam.carrierId === "440001"){
                uploadVideoData();
            }
        }catch (e) {
            console.log("videoList.html---init--error::" + e);
            LMEPG.Log.error("videoList.html---init--error::" + e);
        }
    };

    /**
     * 河南电信epg
     */
    if (RenderParam.carrierId == "410092") {
        LMEPG.Log.info('init HybirdCallBackInterface !!!!!');
        try {
            HybirdCallBackInterface.setCallFunction(function (param) {
                LMEPG.Log.info('HybirdCallBackInterface param : ' + JSON.stringify(param));
                if (param.tag == HybirdCallBackInterface.EVENT_KEYBOARD_BACK) {
                    LMEPG.Intent.back();
                }
            });
        } catch (e) {
            LMEPG.UI.logPanel.show("e");
        }
    }

    function uploadVideoData(){
        LMEPG.ajax.postAPI('Player/getRecommendVideoInfo', null, function (rsp) {
            if(rsp.result === 0){
                var val = JSON.parse(rsp.data[0].ftp_url);
                var data = {
                    startTime:getNowDate() ,
                    contentId:val.gq_ftp_url,
                    contentName:rsp.data[0].title,
                };
                LMEPG.Log.info("uploadData data:"+JSON.stringify(data));
                LMAndroid.jsCallAndroid('doExportContentDetail', JSON.stringify(data), '');
            }
        });
    }
    function getRandom(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }
    function getNowDate() {
        var dateTime=new Date();
        dateTime=dateTime.setSeconds(dateTime.getSeconds()- getRandom(40,120));
        var date = new Date(dateTime);
        var year = date.getFullYear() // 年
        var month = date.getMonth() + 1; // 月
        var day  = date.getDate(); // 日
        var hour = date.getHours(); // 时
        var minutes = date.getMinutes(); // 分
        var seconds = date.getSeconds() //秒
        // 给一位数数据前面加 “0”
        if (month >= 1 && month <= 9) {
            month = "0" + month;
        }
        if (day >= 0 && day <= 9) {
            day = "0" + day;
        }
        if (hour >= 0 && hour <= 9) {
            hour = "0" + hour;
        }
        if (minutes >= 0 && minutes <= 9) {
            minutes = "0" + minutes;
        }
        if (seconds >= 0 && seconds <= 9) {
            seconds = "0" + seconds;
        }
        var currentdate = year  + month  + day +  hour  + minutes  + seconds;
        return currentdate;
    }
</script>
</html>