<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>APKTest</title>
    <link rel="stylesheet" type="text/css" href="__ROOT__/Public/css/{$platformType}/common.css?t={$time}"/>

    <!--全局渲染参数-->
    <script type="text/javascript">
        var RenderParam = {
            //公共渲染
            carrierId: "{$carrierId}",          // 地区id
            areaCode: "{$areaCode}",            // 省份地区码
            subAreaCode: "{$subAreaCode}",      // 省份下的子区域
            platformType: "{$platformType}",    // 平台类型
            debug: "{$debug}",                  // 调试模式
            pageSize: "{$size}",                // 页面尺寸
            stbModel: "{$stbModel}",            // 盒子的型号
            fsUrl: "{$resourcesUrl}",           // fs 地址
            time: "{$time}",                    // 开始渲染时间
            isVip: {$isVip},                    // 用户是不是vip，1 -- 是vip
            userId: "{$userId}",                // 用户Id
            accountId: "{$accountId}",          // 用户Id
            returnUrl: "{$returnUrl}",          // 父页面
            focusId: "{$focusId}",              // 默认焦点

            //当前页渲染
            appName: "{$appName}",
            appUrl: "{$appUrl}",
        }
    </script>
    <!--第三方依赖库-->
    <script type="text/javascript" src="__ROOT__/Public/ThirdParty/js/json2.js?t={$time}"></script>
    <!--公用库-->
    <script type="text/javascript" src="__ROOT__/Public/Common/js/lmcommon.js?t={$time}"></script>
<eq name="isRunOnAndroid" value="1">
    <script type="text/javascript" src="__ROOT__/Public/Common/js/android.js?t={$time}"></script>
</eq>
    <script type="text/javascript" src="__ROOT__/Public/Common/js/lmui.js?t={$time}"></script>
    <!--当前模块js-->

    <style type="text/css">
        body {
            background-image: url('../../../../Public/img/{$platformType}/Common/{$commonImgsView}/bg_home.png');
            padding: 20px;
        }

        table {
            margin-top: 20px;
            margin-bottom: 20px;
        }

        table tr td {
            color: #FF00FF;
            font-size: 25px;
            line-height: 37px;
        }

        span {
            color: #FFFFFF;
            font-size: 32px;
            margin-bottom: 20px;
        }

        .divider-line {
            margin-top: 20px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
<div id="debug" style=" display: block;color:white;z-index:999;"></div>
<div>
    <hr class="divider-line" />
    <span>该页面为epg->apk测试页面：</span>
    <table>
        <tr><td>5号键：在线问诊</td></tr>
        <tr><td>6号键：视频问专家</td></tr>
        <tr><td>7号键：视频问专家记录</td></tr>
        <tr><td>8号键：在线问诊记录</td></tr>
    </table>
</div>
</body>

<script type="text/javascript">
    /** aandroid apk 管理类 */
    var appManager = (function () {
        return {
            isInstall: function (appName) {
                return STBAppManager.isAppInstalled(appName);
            },
            startApp: function (appName) {
                if (this.isInstall(appName)) {
                    STBAppManager.startAppByName(appName);
                }
            },
            restartApp: function (appName) {
                if (this.isInstall(appName)) {
                    STBAppManager.restartAppByName(appName);
                }
            },
            installApp: function (url) {
                STBAppManager.installApp(url)
            },
        }
    })();
</script>

<script type="text/javascript">
    var debug = document.getElementById("debug");

    function testStartAudioPlay() {
        if (RenderParam.carrierId != '000051') {
            return;
        }

        var src = LMEPG.Intent.createIntent('debugCallApkTest');
        src.setParam('userId', RenderParam.userId);
        src.setParam('carrierId', RenderParam.carrierId);

        var dst = LMEPG.Intent.createIntent('debugAudioPlayTest');
        LMEPG.Intent.jump(dst, src);
    }

    function testInstallApp() {
        var apkUrl = "http://test-healthiptv-fs.langma.cn:8091/download/apk/app-chinaunicom-debug.apk";
        appManager.installApp(apkUrl);
    }

    function testStartApp(appName) {
        appManager.startApp(appName);
    }

    function testStartAppByIntent(intentMessage) {
        debug.innerHTML = intentMessage;
        STBAppManager.startAppByIntent(intentMessage);
    }

    //页面加载完成
    window.onload = function () {
        if (typeof STBAppManager == "undefined") {
            debug.innerHTML = "STBAppManager undefined";
        } else {
            debug.innerHTML = "STBAppManager start test";
        }
    };

    document.onkeydown = function (event) {
        var keyCode = window.event ? event.keyCode : event.which;
        switch (keyCode) {
            case 48:
                // 0键
                testStartAudioPlay();
                break;
            case 49:
                // 1键
                testInstallApp();
                break;
            case 50:
                // 2键
                var appName = "com.longmaster.iptv.health.chinaunicom";
                //var appName = "com.longmaster.iptv.health.jiangsudx";
                testStartApp(appName);
                break;
            case 51:
                // 3键
                var appName = "com.longmaster.iptv.health.chinaunicom";
                //var appName = "com.longmaster.iptv.health.jiangsudx";
                var className = "com.longmaster.iptv.health.booter.router.ProxyActivity";
                var data = '{\"linkType\":1,\"type\":\"101\",\"linkUrl\":\"http:\/\/www.baidu.com\",\"linkName\":\"subject\"}';
                var intentMessage = '{\"intentType\":0,\"appName\":\"' + appName + '\", \"className\":\"' + className
                    + '\",\"extra\":[{\"name\":\"data\",\"value\":' + data + '}]}';
                testStartAppByIntent(intentMessage);
                break;
            case 52:
                // 4键
                alert("开始启动应用商城");
                var appName = "com.huawei.dsm";     // TV中心商城
                var className = "com.huawei.dsm.activity.AppDetailActivity";    // 下载页
                var data = '{\"appId\": \"sjjk\",\"showType\":2,\"contentId\":\"sjjk\"}';
                var intentMessage = '{\"intentType\":0,\"appName\":\"' + appName + '\", \"className\":\"' + className
                    + '\",\"extra\":[{\"name\":\"data\",\"value\":' + data + '}'
                    + ',{\"name\":\"appId\",\"value\":\"sjjk\"}'
                    + ',{\"name\":\"showType\",\"value\":2}'
                    + ',{\"name\":\"contentId\",\"value\":\"sjjk\"}'
                    + ']}';
                //testStartApp(appName);
                appManager.restartApp(appName);
                setTimeout(function () {
                    testStartAppByIntent(intentMessage);
                }, 5000);
                break;

            case 53:
                // 按5 测试在线问诊
                var objTestApk = LMEPG.Intent.createIntent("debugCallApkTest");
                objTestApk.setParam("userId", RenderParam.userId);


                var objDoctorP2P = LMEPG.Intent.createIntent("doctorList");
                objDoctorP2P.setParam("userId", "{$userId}");

                LMEPG.Intent.jump(objDoctorP2P, objTestApk);
                break;
            case 54:
                // 按5 视频问专家
                var objTestApk = LMEPG.Intent.createIntent("debugCallApkTest");
                objTestApk.setParam("userId", RenderParam.userId);


                var objDoctorP2P = LMEPG.Intent.createIntent("expertHome");
                objDoctorP2P.setParam("userId", "{$userId}");

                LMEPG.Intent.jump(objDoctorP2P, objTestApk);
                break;
            case 55:
                var objTestApk = LMEPG.Intent.createIntent("debugCallApkTest");
                objTestApk.setParam("userId", RenderParam.userId);


                var objDoctorP2P = LMEPG.Intent.createIntent("expertRecordHome");
                objDoctorP2P.setParam("userId", "{$userId}");

                LMEPG.Intent.jump(objDoctorP2P, objTestApk);

                break;
            case 56:
                var objTestApk = LMEPG.Intent.createIntent("debugCallApkTest");
                objTestApk.setParam("userId", RenderParam.userId);


                var objDoctorP2P = LMEPG.Intent.createIntent("doctorRecordHome");
                objDoctorP2P.setParam("userId", "{$userId}");

                LMEPG.Intent.jump(objDoctorP2P, objTestApk);

                break;
            case 8:
                LMEPG.Intent.back();
                break;
        }
    }
</script>
</html>